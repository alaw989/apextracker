---
phase: 01-core-lookup
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/utils/constants.js
  - src/utils/platformIcons.js
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Platform constants are exported and usable"
    - "Platform icons are available as Vue components"
    - "Background images exist in public directory or assets"
    - "Utility functions can be imported without errors"
  artifacts:
    - path: "src/utils/constants.js"
      provides: "Platform codes and API configuration"
      exports: ["PLATFORMS", "API_CONFIG"]
    - path: "src/utils/platformIcons.js"
      provides: "Platform icon Vue components"
      exports: ["PlatformIcons"]
    - path: "src/utils/backgrounds.js"
      provides: "Background image mappings"
      exports: ["getBackgroundForLegend"]
    - path: "src/assets/images/"
      provides: "Legend background images"
      contains: "*.jpg, *.png"
  key_links:
    - from: "src/stores/player.js"
      to: "src/utils/constants.js"
      via: "import { PLATFORMS, API_CONFIG }"
      pattern: "PLATFORMS\\[.*\\]"
---

<objective>
Create utility functions, constants, and assets needed for API integration and platform selection.

Purpose: Extract hardcoded values from the React app into reusable constants. Create platform icon components for the search interface. Prepare background image mappings for Phase 2. This utilities layer supports the API integration and UI components in later plans.

Output: Constants file with platform mappings, Vue-compatible platform icon components, background image utilities, and migrated assets.
</objective>

<execution_context>
@/home/deck/.claude/get-shit-done/workflows/execute-plan.md
@/home/deck/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-core-lookup/01-CONTEXT.md
@.planning/phases/01-core-lookup/01-RESEARCH.md
@src/utils.js
@src/components/*.js
</context>

<tasks>

<task type="auto">
  <name>Create platform constants and API config</name>
  <files>src/utils/constants.js</files>
  <action>
    Create src/utils/constants.js with:

    1. PLATFORMS object mapping UI-friendly names to API slugs:
       - { id: 'origin', name: 'PC', icon: 'pc' }
       - { id: 'xbl', name: 'Xbox', icon: 'xbox' }
       - { id: 'psn', name: 'PlayStation', icon: 'psn' }

       Note: API v2 uses string slugs (origin, xbl, psn) NOT numeric codes
       The old React app used numbers (1, 2, 5) - we're updating to v2 slugs

    2. API_CONFIG object:
       - API_KEY: '05e6eb8f-3e95-4fbb-a2b5-b0f4dbb124c9' (existing key)
       - BASE_URL: 'https://public-api.tracker.gg/v2/apex/standard/profile'
       - PROXY_URL: import.meta.env.VITE_PROXY_URL || 'https://fathomless-mesa-94824.herokuapp.com/'

       Store proxy URL as env var for easy migration to DigitalOcean later

    3. ERROR_MESSAGES:
       - PLAYER_NOT_FOUND: 'Player not found. Please check the username and platform.'
       - NETWORK_ERROR: 'Network error. Please try again.'
       - RATE_LIMIT: 'Too many requests. Please wait a moment.'

    Export as named exports: PLATFORMS, API_CONFIG, ERROR_MESSAGES
  </action>
  <verify>
    1. Create test file src/utils/constants.test.js or verify in browser console
    2. Import and log: console.log(PLATFORMS, API_CONFIG)
    3. Verify:
       - PLATFORMS has 3 entries with correct id values
       - API_CONFIG has all required properties
       - No syntax errors when importing
  </verify>
  <done>
    Constants file exports PLATFORMS array, API_CONFIG object, ERROR_MESSAGES object
  </done>
</task>

<task type="auto">
  <name>Create platform icon components</name>
  <files>src/utils/platformIcons.js</files>
  <action>
    Create src/utils/platformIcons.js with Vue component exports:

    1. Convert existing SVG icons from src/components/*SVG.js to Vue format:
       - XboxSVG.vue component
       - PlaystationSVG.vue component
       - WindowsSVG.vue component (for PC)

    2. Create PlatformIcons.vue component that:
       - Props: platform (string: 'origin', 'xbl', 'psn')
       - Uses computed property to select correct icon
       - Renders the appropriate SVG component

    3. Export default PlatformIcons component

    SVG paths should be copied exactly from existing React components:
    - src/components/XboxSVG.js
    - src/components/PlaystationSVG.js
    - src/components/WindowsSVG.js

    Fill color: #CAD0E3 (from existing codebase)
  </action>
  <verify>
    1. Create src/App.vue test that renders PlatformIcons for each platform
    2. Run dev server and verify icons render visibly
    3. Check that platform prop switching changes the icon
  </verify>
  <done>
    PlatformIcons component renders correct SVG for each platform value
  </done>
</task>

<task type="auto">
  <name>Create background utilities and migrate assets</name>
  <files>src/utils/backgrounds.js, public/images/ or src/assets/images/</files>
  <action>
    1. Copy existing legend background images from src/images/ to public/images/legends/:
       - pathfinder.jpg, bangalore.png, bloodhound.png, caustic.png
       - gibraltar.png, lifeline.png, mirage.png, wattson.png, wraith.png, octane.png

    2. Create src/utils/backgrounds.js:
       - Export getBackgroundForLegend(legendName) function
       - Maps legend name to image path: /images/legends/{name}.jpg (or .png)
       - Returns null for unknown legends
       - Handles case-insensitive matching

       Example:
       export function getBackgroundForLegend(legendName) {
         const nameMap = {
           'pathfinder': 'pathfinder.jpg',
           'bangalore': 'bangalore.png',
           // ... all legends
         }
         const key = legendName?.toLowerCase()
         const filename = nameMap[key]
         return filename ? `/images/legends/${filename}` : null
       }

    3. Create default fallback image:
       - Add a generic apex-themed background as /images/legends/default.jpg
       - If file doesn't exist, use a dark gradient placeholder

    Note: Backgrounds are used in Phase 2, but setting up the mapping now.
  </action>
  <verify>
    1. List public/images/legends/ directory - should have 9 legend images
    2. Test getBackgroundForLegend('Pathfinder') returns correct path
    3. Test getBackgroundForLegend('Unknown') returns null
  </verify>
  <done>
    Legend images are in public/images/legends/, getBackgroundForLegend function works correctly
  </done>
</task>

</tasks>

<verification>
After all tasks complete, verify:
- [ ] All utility files can be imported without errors
- [ ] PlatformIcons component renders each platform's icon
- [ ] Legend background images exist in public directory
- [ ] getBackgroundForLegend returns valid paths for known legends
- [ ] API_CONFIG has correct API key and proxy URL
</verification>

<success_criteria>
1. PLATFORMS constant has 3 entries (origin, xbl, psn) with correct names
2. API_CONFIG contains API_KEY, BASE_URL, PROXY_URL
3. PlatformIcons component renders correct SVG for each platform
4. Legend background images are accessible at /images/legends/{name}
5. getBackgroundForLegend utility returns correct image paths
</success_criteria>

<output>
After completion, create `.planning/phases/01-core-lookup/01-02-SUMMARY.md`
</output>
