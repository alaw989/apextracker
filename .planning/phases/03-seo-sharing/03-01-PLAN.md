---
phase: 03-seo-sharing
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - package-lock.json
  - src/router/index.js
  - src/main.js
  - src/App.vue
  - src/views/HomeView.vue
  - src/views/PlayerView.vue
  - src/views/NotFoundView.vue
autonomous: false

must_haves:
  truths:
    - "Vue Router 4 is installed and registered in main.js"
    - "App has route for / (home) and /player/:username/:platform"
    - "Navigating to /player/ExampleUser/origin auto-fetches that player's stats"
    - "Search form navigates to player URL on successful search"
    - "Invalid URL patterns show 404 page"
    - "Invalid platform in URL redirects to 404"
  artifacts:
    - path: "package.json"
      provides: "Project dependencies"
      contains: "vue-router"
    - path: "src/router/index.js"
      provides: "Vue Router configuration with routes"
      exports: ["default", "createRouter", "createWebHistory"]
    - path: "src/views/HomeView.vue"
      provides: "Homepage view with search form"
      min_lines: 30
    - path: "src/views/PlayerView.vue"
      provides: "Player profile view"
      min_lines: 40
    - path: "src/views/NotFoundView.vue"
      provides: "404 not found page"
      min_lines: 20
  key_links:
    - from: "src/main.js"
      to: "src/router/index.js"
      via: "app.use(router)"
      pattern: "import.*router"
    - from: "src/views/HomeView.vue"
      to: "src/views/PlayerView.vue"
      via: "router.push({ name: 'player' })"
      pattern: "router.push"
    - from: "src/views/PlayerView.vue"
      to: "src/stores/player.js"
      via: "usePlayerStore"
      pattern: "usePlayerStore"
---

<objective>
Install and configure Vue Router 4 for shareable player profile URLs.

Purpose: Enable players to share their stats via URL (e.g., /player/username/origin) and make the app navigable via browser back/forward buttons. This is the foundation for SEO and social sharing.

Output: Working Vue Router with home route, dynamic player route with params, and 404 handling.
</objective>

<execution_context>
@/home/deck/.claude/get-shit-done/workflows/execute-plan.md
@/home/deck/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/REQUIREMENTS.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-seo-sharing/03-CONTEXT.md
@.planning/phases/03-seo-sharing/03-RESEARCH.md

# Phase 1-2 Context
@.planning/phases/01-core-lookup/01-01-SUMMARY.md
@.planning/phases/02-visual-polish/02-01-SUMMARY.md

# Existing code
@src/App.vue
@src/stores/player.js
@src/utils/constants.js
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Vue Router 4</name>
  <files>package.json, package-lock.json</files>
  <action>
    Install Vue Router 4 as a dependency:

    ```bash
    npm install vue-router@4
    ```

    DO NOT install any other routing libraries - vue-router@4 is the official solution for Vue 3.
  </action>
  <verify>
    package.json contains "vue-router" in dependencies with version ^4.x
  </verify>
  <done>
    Vue Router 4 is installed and appears in package.json
  </done>
</task>

<task type="auto">
  <name>Task 2: Create router configuration</name>
  <files>src/router/index.js</files>
  <action>
    Create src/router directory and src/router/index.js with the following:

    1. Import createRouter and createWebHistory from vue-router
    2. Define three routes:
       - / (home) - HomeView component
       - /player/:username/:platform - PlayerView component with props: true
       - /:pathMatch(.*)* - NotFoundView component (catch-all 404)
    3. Use createWebHistory with import.meta.env.BASE_URL
    4. Add scrollBehavior to reset scroll to top on navigation
    5. Add beforeEach guard to validate platform parameter

    Route meta for titles (will be used in plan 03-02):
    - home: "Apex Legends Stats Tracker - Lookup Player Ranks & Stats"
    - player: dynamic (will use username)
    - notFound: "404 - Player Not Found"

    Platform validation in beforeEach:
    - Check if to.params.platform is in ['origin', 'xbl', 'psn'] from PLATFORMS constant
    - Invalid platform: redirect to NotFound

    DO NOT use hash mode - use history mode for clean URLs
    DO NOT forget the catch-all route must be LAST in the array
  </action>
  <verify>
    File exists at src/router/index.js with:
    - createRouter imported and used
    - createWebHistory for history mode
    - Three routes defined: home, player with params, catch-all
    - beforeEach guard validates platform
    - scrollBehavior returns { top: 0 }
  </verify>
  <done>
    Router instance is exported with all routes and guards configured
  </done>
</task>

<task type="auto">
  <name>Task 3: Create HomeView component</name>
  <files>src/views/HomeView.vue</files>
  <action>
    Create src/views directory and src/views/HomeView.vue that contains the search interface.

    This should move the existing search form from App.vue into a dedicated view component:

    1. Copy the search form section from App.vue (lines 76-111 approximately)
    2. Include imports for SearchInput, PlatformSelect, SearchButton
    3. Include local state for username and platform
    4. Include handleSearch function that navigates to player route on success
    5. Include ErrorMessage and loading/error states display

    Handle search by:
    - Calling playerStore.searchPlayer(username, platform)
    - On success: router.push({ name: 'player', params: { username, platform } })
    - On error: Show error message in UI

    DO NOT include player results display in HomeView - that's for PlayerView
  </action>
  <verify>
    File exists at src/views/HomeView.vue with:
    - Search form with SearchInput, PlatformSelect, SearchButton
    - handleSearch function that navigates to 'player' route
    - Error message display
    - Loading spinner during search
  </verify>
  <done>
    HomeView renders the search form and navigates to player route on successful search
  </done>
</task>

<task type="auto">
  <name>Task 4: Create PlayerView component</name>
  <files>src/views/PlayerView.vue</files>
  <action>
    Create src/views/PlayerView.vue that displays player stats from URL params.

    Component requirements:
    1. Accept props: username, platform (from route params via props: true)
    2. Use usePlayerStore to access player data
    3. Use useRoute to watch for route param changes
    4. Auto-fetch on mount when URL is visited directly
    5. Display player header, stats, and legends (from existing components)
    6. Show loading state while fetching
    7. Show 404-style error if player not found from API

    Template structure:
    - If loading: show LoadingSpinner
    - If error: show error message with "Search for another player" button
    - If data: show PlayerHeader, StatsList, FavoriteLegends
    - Include search form at top for quick new search

    Watch behavior:
    - Watch route.params for changes
    - When username or platform changes, refetch player data
    - Use immediate: true to fetch on component mount

    Error handling:
    - If API returns 404 (player not found), show friendly error
    - Include "Back to home" button

    DO NOT reuse the same search form from HomeView - create a minimal version for PlayerView
  </action>
  <verify>
    File exists at src/views/PlayerView.vue with:
    - Props definition for username and platform
    - Watch on route.params with immediate: true
    - PlayerHeader, StatsList, FavoriteLegends components rendered
    - Loading and error state handling
    - "Search for another player" functionality
  </verify>
  <done>
    PlayerView displays player stats when visiting /player/:username/:platform URL directly
  </done>
</task>

<task type="auto">
  <name>Task 5: Create NotFoundView component</name>
  <files>src/views/NotFoundView.vue</files>
  <action>
    Create src/views/NotFoundView.vue for 404 pages.

    Component requirements:
    1. Display "404 - Player Not Found" heading
    2. Show helpful message: "The player you're looking for doesn't exist on this platform."
    3. Include "Search for another player" button that navigates to home
    4. Use BaseButton component for the navigation button
    5. Center content vertically and horizontally

    Styling:
    - Use existing CSS variables (--spacing-2xl, --text-primary, etc.)
    - Center aligned text
    - Minimal clean design matching app aesthetic

    DO NOT show the search form on the 404 page - just the navigation button
  </action>
  <verify>
    File exists at src/views/NotFoundView.vue with:
    - 404 heading and helpful message
    - Navigation button to home route
    - Centered layout using CSS
  </verify>
  <done>
    NotFoundView displays when visiting invalid URL patterns
  </done>
</task>

<task type="auto">
  <name>Task 6: Register router in main.js and update App.vue</name>
  <files>src/main.js, src/App.vue</files>
  <action>
    Update main.js and App.vue to integrate Vue Router:

    main.js changes:
    1. Import router from './router'
    2. Call app.use(router) before app.mount('#app')

    App.vue changes:
    1. Remove search form (moved to HomeView)
    2. Keep AppBackground component
    3. Replace content with <RouterView /> component
    4. Add computed favoriteLegend from playerStore for background
    5. Keep existing styles for .app container

    App.vue structure after changes:
    ```vue
    <template>
      <AppBackground :favorite-legend="favoriteLegend" />
      <div class="app">
        <div class="app__container">
          <RouterView />
        </div>
      </div>
    </template>
    ```

    DO NOT forget to import RouterView from vue-router
    DO NOT remove the AppBackground - it needs to work across all routes
  </action>
  <verify>
    main.js contains:
    - Import of router from './router'
    - app.use(router) before mount

    App.vue contains:
    - RouterView component rendered
    - AppBackground with favoriteLegend prop
    - No search form (moved to HomeView)
  </verify>
  <done>
    Router is registered and RouterView renders the correct view for each route
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Vue Router integration with shareable player URLs (ShareButton added in plan 03-05)</what-built>
  <how-to-verify>
1. Start dev server: npm run dev
2. Visit http://localhost:5173 - should show home search form
3. Search for a player (e.g., "ExampleUser" on "PC")
4. Verify URL changes to /player/ExampleUser/origin
5. Click browser back button - should return to home
6. Copy the URL, open in new tab - should auto-load that player's stats
7. Try an invalid URL pattern like /invalid/path - should show 404 page
8. Try an invalid platform like /player/User/invalid - should show 404 page

Expected behavior:
- Home route shows search form
- Player URL format: /player/:username/:platform
- Direct URL visit auto-fetches player data
- Invalid URLs show 404 page
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues with routing behavior</resume-signal>
</task>

</tasks>

<verification>
After all tasks complete, verify:
- [ ] `npm run dev` starts without errors
- [ ] Visiting / shows home search form
- [ ] Searching navigates to /player/:username/:platform
- [ ] Direct URL visit loads player stats
- [ ] Invalid URLs show 404 page
- [ ] Browser back/forward buttons work
</verification>

<success_criteria>
1. Vue Router 4 is installed and configured
2. App has routes for home, player profiles, and 404
3. Player URLs follow format /player/:username/:platform
4. Visiting a player URL directly auto-fetches their stats
5. Invalid URLs or invalid platforms show 404 page
</success_criteria>

<output>
After completion, create `.planning/phases/03-seo-sharing/03-01-SUMMARY.md`
</output>
